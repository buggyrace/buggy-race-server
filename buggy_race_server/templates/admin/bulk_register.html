{% extends "layout.html" %}
{% block content %}
{%include "admin/_nav.html" %}
<div class="container pb-5">
  <div class="row">
    <h1>Bulk Register</h1>
  </div>

  <div id="registration-progress" style="display:none">
    <div class="d-inline-block">
      <table id="registration-summary" class="table table-striped table-bordered table-hover">
        <thead>
          <tr class="text-right">
              <th>Records</th>
              <th>Fail</th>
              <th>OK</th>
              <th>Completed</th>
          </tr>
        </thead>
        <tbody>
          <tr class="text-right">
            <td id="reg-qty-records">0</td>
            <td id="reg-qty-fail" class="list-group-item-danger">0</td>
            <td id="reg-qty-ok" class="list-group-item-success">0</td>
            <td id="reg-qty-done">0</td>
          </tr>
          <tr>
            <td colspan="3">Progress</td>
            <td class="text-right"><span id="reg-qty-done-percent">0</span>%</td>
          </tr>
        </tbody>
      </table>
    </div>
    <ul class="row">
    </ul>
    <div class="alert" id="registration-status">
    </div>
  </div>

  <div class="row my-3">
    <form id="registerForm" class="form form-register" method="POST" action="" role="form">
      {{ form.csrf_token }}
      {{ form.is_json() }}
      {% if has_auth_code is sameas true %}
        <div class="alert alert-danger">
          Registration is not public on this server:<br>
          you <strong>must</strong> provide a valid authorisation code to register users!
        </div>
        <div class="form-group">
            {{form.authorisation_code.label}}
            {{form.authorisation_code(class_="form-control")}}
        </div>
      {% endif %}
      <div class="form-group">
        <p>
          Bulk upload by pasting a CSV in here, with a header row as
          the first line (no spaces). Probably best in small batches.
        </p>
          {{form.userdata.label}}
          {{form.userdata(placeholder="username,password,...", class_="form-control")}}
      </div>
      <p><input class="btn btn-primary" type="submit" value="Register"></p>
    </form>
  </div>

  <div class="row">
    <p class="mt-5">
      Alternatively: <a href="{{ url_for('public.register') }}">individual registration</a>.
    </p>
  </div>
</div>
{% endblock %}

