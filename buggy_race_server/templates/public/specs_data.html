
{% extends "layout.html" %}

{% block content %}
<div class="container pb-5">
  <div class="row">
    <h1 class="mt-5">Buggy Specifications: data</h1>
  </div>
  <div class="row">
    <p class="lead">
      This is tabulated data from the
      <a href="{{ url_for( 'public.showspecs' ) }}">buggy specifications</a>.
    </p>
  </div>
  <div class="row">
    <ul>
      <li><a href="#values">Values</a>
        <ul>
          {% for type in data %}
            <li>
              <a href="#type-{{type}}">{{ type | title | replace('_', ' ') }}</a>
            </li>
          {% endfor %}
        </ul>
      </li>
      <li><a href="#defaults">Defaults</a></li>
      <li><a href="#json">JSON format</a> </li>
    </ul>
  </div>
  <div class="row">
    {% if is_showing_mass %}
      <p>
        <strong>With mass data</strong><br>
        This data <strong>does include</strong> values for mass but you don't
        normally need it. See the data
        <a href="{{ url_for('public.showspecs_data') }}">without mass</a>.
      </p>
    {% else %}
      <p>
        <strong>Without mass data</strong><br>
        This data doesn't include values for mass because you don't normally
        need it. If you prefer,
        <a href="{{ url_for('public.showspecs_data') }}?extra=mass">display mass</a>
        too.
      </p>
    {% endif %}
  </div>
  <div class="row">
    <h2 id="values" class="mt-5">
      Buggy specifications: values
    </h2>
  </div>
  
  <div class="row">

  {% for type in data %}
    {% set pretty_type = type | title | replace('_', ' ') %}
    <h3 class="mt-5" id="type-{{type}}">{{ pretty_type }}</h3>
    {% set sample_key = data[type].keys() | first  %}
    <table class="table table-striped table-bordered table-hover table-responsive elastic">
      <thead class="thead-light">
        <tr>
          <th> {{ pretty_type }} </th>
          {% if data[type][sample_key]["cost"] is defined %}
            <th> Cost (points) </th>
          {% endif %}
          {% if is_showing_mass %}
            {% if data[type][sample_key]["mass"] is defined %}
              <th> Mass (kg) </th>
            {% endif %}
          {% endif %}
          {% if data[type][sample_key]["consum"] %}
            <th> Is consumable? </th>
          {% endif %}
          <th> Description </th>
        </tr>
      </thead>
      <tbody>
        {% for key in data[type] | sort %}
        <tr>
          <td>
            <code>{{ key }}</code>
          </td>
          {% if data[type][sample_key]["cost"] is defined %}
            <td class="number"> {{ data[type][key]["cost"] }} </td>
          {% endif %}
          {% if is_showing_mass %}
            {% if data[type][sample_key]["mass"] is defined %}
              <td class="number"> {{ data[type][key]["mass"] }} </td>
            {% endif %}
          {% endif %}
          {% if type == "power_type" %}
            <td>
              {{ data[type][key]["consum"] }}
            </td>
          {% endif %}
          <td>
            {{ data[type][key]["desc"] }}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endfor %}
 </div>

  <div class="row">
    <h2 id="defaults" class="mt-5">
      Buggy specifications: Defaults
    </h2>
  </div>
  <div class="row">
    <table class="table table-striped table-bordered table-hover table-responsive">
      <thead class="thead-light">
        <tr>
          <th>Item</th>
          <th>Default value</th>
        </tr>
      </thead>
      <tbody>
        {% for key in defaults | sort %}
          {% set value = ""~defaults[key] %}
          {% set is_number = value.isdigit() %}
          {% set is_bool = value == "False" or value == "True" or value == "None"%}
          <tr>
            <td>
              <code>{{ key }}</code>
            </td>
            <td {%if is_number %}class="number"{% endif %}>
              {% if not(is_number or is_bool) %}<code>{% endif %}
                {{ defaults[key] }}
              {% if not(is_number or is_bool) %}</code>{% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

  </div>

  <div class="row">
    <h2 id="json" class="mt-5">
      Data in JSON format
    </h2>
  </div>

  <div class="row">
    <div class="col">
      <p class="btn-collection">
        <a class="btn btn-outline-secondary" href="{{ url_for('public.showspecs_data', data_filename='types.json')}}">Download <strong>values</strong> as JSON &dtri;</a>
        <a class="btn btn-outline-secondary" href="{{ url_for('public.showspecs_data', data_filename='defaults.json')}}">Download <strong>defaults</strong> as JSON &dtri;</a>
      </p>
    </div>
  </div>

</div>
{% endblock %}

